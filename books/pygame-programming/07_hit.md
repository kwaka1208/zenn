---
title: 敵の当たり判定を作ろう
---
敵キャラクターに弾が当たったかどうかを判定し、当たった時の処理を追加します。

## 手順
### フラグを追加しよう
> プログラムの31〜33行目
敵に弾が当たったかどうかを記憶するするためのフラグ"hit"を追加します。

## 当たり判定を追加しよう
> プログラムの91〜97行目です。

敵キャラに弾があたったかどうかを判定し、当たったらキャラクターの向きを上下反対にします。

当たり判定には、colliderectという関数を使います。

```python
enemy_rect.colliderect(bullet_rect)
```
この例では、敵の矩形と弾の矩形が重なっているかどうかを判定しています。

当たったら、弾キャラクターのY座標を画面外に移動させ、当たったことを示す"hit"フラグをTrueにします。

## 敵が再出現した時に向きを元に戻そう
> プログラムの80〜84行目です。

敵が画面の端に行った時、画面の上から再度出現させますが、この時弾に当たっていたら向きを元に戻します。

また、"hit"フラグをFalseに戻します。

## プログラムを入力しよう
1. 前回作成した"game.py"を開きます。
1. 以下のコードの赤い枠の中を"game.py"に追加していきましょう。
1. 入力したら保存します。保存の操作は、ChromebookとWindowsの方は"Ctrl" + "S"、Macの方は"Command" + "S"です。プログラムの保存は最後にまとめてやるのではなく、ある程度入力したら保存するの方が良いです。もし入力途中でトラブルが起こったらせっかく入力したプログラムが消えてしまう可能性があります。

画像をクリックすると拡大表示されます（[こちらをクリックすると別ウインドウでオリジナルのソースコードが表示できます](https://github.com/kwaka1208/resources/blob/main/pygame/game07.py)）
[![](https://raw.githubusercontent.com/kwaka1208/resources/main/pygame/game07.png)](https://raw.githubusercontent.com/kwaka1208/resources/main/pygame/game07.png)

## 実行してみよう
プログラムの入力ができたら、プログラムを実行してます。以下の手順を参考にしてください。

### Chromebookの方
1. ターミナルを起動します。
1. cd okeikoと入力してEnterキーを押します。
1. python3 game.pyと入力してEnterキーを押します。

### Windowsの方
1. コマンドプロンプトを起動します。
1. cd Documentsと入力してEnterキーを押します。
1. cd okeikoと入力してEnterキーを押します。
1. python game.pyと入力してEnterキーを押します。

### Macの方
1. ターミナルを起動します。
1. cd Documentsと入力してEnterキーを押します。
1. cd okeikoと入力してEnterキーを押します。
1. python3 game.pyと入力してEnterキーを押します。

## 考えてみよう
- 敵キャラクターのY座標もランダムに変えるようにしてみよう。



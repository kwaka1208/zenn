---
title: GoogleスプレッドシートのデータをJSON形式で取得する
emoji: "📊"
type: tech
topics: [Google スプレッドシート, JSON]
published: true
---
## 概要
GoogleスプレッドシートのシートのデータをJSON形式で取得できるようにするシートです。このシートに表形式でデータを入力するとJSON形式で取得できるURLが取得できます。

静的なWebAPIとして機能させられますので、アプリケーションなどからデータを取得できます。以下のリンク先にあるプログラミングの授業での利用におすすめです。

[天気予報他ネット上のデータを取得 | AkaDako](https://akadako.com/3851/)

:::message alert
ここで利用するシートは公開範囲を「リンクを知っている全員」に設定しなければなりませんので、個人を特定できる情報などの機密情報を入力しないでください。一般に公開されているデータや、誰かに見られても差し支えないデータのみを取り扱ってください。
:::


## 使い方
1. シートのコピーを作成します。以下のリンク先をクリックするとシートのコピー画面が表示されます。コピーは最初の一回だけでOKですので、継続して利用する場合はコピーしたシートを使ってください。

[gs2json](https://docs.google.com/spreadsheets/d/1w5qHIz2qMAQlbS-FV3FTB_RGcEElKjCvGzJhJqyeDD8/copy?usp=sharing)

コピーする時に以下のメッセージが表示されていることを確認してください。Apps Scriptの添付が必要です。

![](/images/google/gs2json/copy.png)

2. シートの公開範囲を以下の手順で変更します。この設定をしないとデータへのアクセスができません。
    - メニューの「ファイル」→「共有」→「他のユーザーと共有」をクリックします。
    - 「リンクを知っている全員」と「閲覧者」を選択し「完了」を押します。

![](/images/google/gs2json/access.png)

3. "data"シートの内容を変更して取得したいデータを入力します。一行目はヘッダー行として扱われますので各行の値がわかる文字列を記入してください。ヘッダー行の内容がJSONのキーとして出力されます。

4. 「データの入っているシートの名前」の右側のセル（B1）にデータが入っているシートの名前を入力します。デフォルトでは"data"となっています。
5. 「JSON取得用URL」の右側のセル（B2）に表示されるURLをクリックしてアクセスしてください。JSON形式でデータが別タブで表示されます。
6. 期待通りのデータが表示されることを確認したら、このURLをコピーしてアプリケーションなどから利用してください。

## 使用例
このシートには、初期値として以下のようなデータが入っています。

![](/images/google/gs2json/sample_data.png)

このデータに対して、上記手順で取得したURLを使うと以下のようにJSON形式でアクセスできるようになります。

```json
[{"品名":"バナナ","価格":300,"在庫数":100},{"品名":"りんご","価格":150,"在庫数":120},{"品名":"みかん","価格":120,"在庫数":90}]
```

## 不具合の報告などはこちらへ
こちらのシートに不具合がございましたら、[こちら](https://github.com/kwaka1208/issues/issues)から報告いただけると助かります。